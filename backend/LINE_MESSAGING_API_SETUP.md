# LINE Messaging API - ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç

## ‚ö†Ô∏è ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: Bot ‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°

### ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ:

1. **Auto-reply messages ‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà** - LINE Platform ‡∏à‡∏∞‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏ó‡∏ô Bot
2. **Webhook events ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡∏°‡∏≤** - ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Webhook events
3. **Greeting messages ‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà** - ‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

## üîß ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### 1. ‡∏õ‡∏¥‡∏î Auto-reply Messages

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **LINE Developers Console**: https://developers.line.biz/
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Channel** ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Messaging API** settings
4. ‡∏´‡∏≤ **"Auto-reply messages"** section
5. **‡∏õ‡∏¥‡∏î (Disable)** Auto-reply messages
   - ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Bot ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á

### 2. ‡πÄ‡∏õ‡∏¥‡∏î Webhook

1. ‡πÉ‡∏ô **Messaging API** settings
2. ‡∏´‡∏≤ **"Webhook"** section
3. **‡πÄ‡∏õ‡∏¥‡∏î (Enable)** Webhook
4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ **Webhook URL**: `https://your-domain.com/api/line/webhook`
5. Click **"Verify"** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### 3. ‡πÄ‡∏õ‡∏¥‡∏î Webhook Events

1. ‡πÉ‡∏ô **Messaging API** settings
2. ‡∏´‡∏≤ **"Webhook events"** section
3. ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô events ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:
   - ‚úÖ **Message** - ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
   - ‚úÖ **Follow** - ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Add Friend
   - ‚úÖ **Unfollow** - ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Block/Unfollow
   - ‚úÖ **Postback** - ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
   - ‚úÖ **Account link** - ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ö‡∏±‡∏ç‡∏ä‡∏µ (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)

### 4. ‡∏õ‡∏¥‡∏î Greeting Messages (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)

1. ‡πÉ‡∏ô **Messaging API** settings
2. ‡∏´‡∏≤ **"Greeting messages"** section
3. **‡∏õ‡∏¥‡∏î (Disable)** ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
   - ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á

### 5. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Channel Access Token

1. ‡πÉ‡∏ô **Messaging API** settings
2. ‡∏´‡∏≤ **"Channel access token"** section
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Token ‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
4. ‡∏ñ‡πâ‡∏≤ Token ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ ‡∏ï‡πâ‡∏≠‡∏á **Issue** ‡πÉ‡∏´‡∏°‡πà
5. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï `LINE_CHANNEL_ACCESS_TOKEN` ‡πÉ‡∏ô `.env` file

## üìã Checklist

- [ ] Auto-reply messages **‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß**
- [ ] Webhook **‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß** ‡πÅ‡∏•‡∏∞ verify ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
- [ ] Webhook events **‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß** (Message, Follow, Unfollow)
- [ ] Channel Access Token **‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á** ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
- [ ] Webhook URL **‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á** ‡πÅ‡∏•‡∏∞ accessible
- [ ] Environment variables **‡∏ñ‡∏π‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß**

## üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Logs

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö server logs:

### ‡∏ñ‡πâ‡∏≤ Webhook ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:
```
üì• LINE webhook received: { hasBody: true, hasEvents: true, eventCount: 1 }
üì® Processing LINE event: message
üì§ Sending LINE message to Uxxx...
‚úÖ LINE message sent successfully
```

### ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤:
```
üì• LINE webhook received: { hasBody: true, hasEvents: true, eventCount: 0 }
‚ö†Ô∏è  No events in webhook body
```

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏**: ‡∏ñ‡πâ‡∏≤ `eventCount: 0` ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤:
- Auto-reply messages ‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà
- ‡∏´‡∏£‡∏∑‡∏≠ Webhook events ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

## üéØ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (‡∏™‡∏£‡∏∏‡∏õ)

1. **LINE Developers Console** ‚Üí **Messaging API**
2. **‡∏õ‡∏¥‡∏î** Auto-reply messages
3. **‡πÄ‡∏õ‡∏¥‡∏î** Webhook ‡πÅ‡∏•‡∏∞ verify
4. **‡πÄ‡∏õ‡∏¥‡∏î** Webhook events (Message, Follow, Unfollow)
5. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö** Channel Access Token
6. **Restart** server
7. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö** ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô LINE

## üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

- **Auto-reply messages** ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Bot ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ
- **Webhook events** ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ LINE ‡∏™‡πà‡∏á events ‡∏°‡∏≤
- **Channel Access Token** ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö `.env` file
- ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç settings ‡∏ï‡πâ‡∏≠‡∏á **restart server**

